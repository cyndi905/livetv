"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[482],{2999:function(ce,k,t){t.d(k,{p:function(){return s},v:function(){return D}});var z=t(88767),x=t(85893),s=new z.QueryClient({defaultOptions:{queries:{staleTime:30*1e3,refetchInterval:!1,refetchIntervalInBackground:!1,refetchOnWindowFocus:!1}}}),D=function(S){var j=S.children;return(0,x.jsx)(z.QueryClientProvider,{client:s,children:j})}},82250:function(ce,k,t){t.d(k,{h:function(){return j}});var z=t(5574),x=t.n(z),s=t(64599),D=t.n(s),m=t(30937),S=t(82188),j=new m.YD({timeout:1e4,baseURL:"/api",withCredentials:!0});j.interceptors.request.use(function(r){if(r.headers["Content-Type"]==="multipart/form-data"){var b=new FormData;for(var A in r.data)r.data[A]!==void 0&&r.data[A]!==null&&b.append(A,r.data[A]);r.data=b}if(r.headers["Content-Type"]==="application/x-www-form-urlencoded"){var T=new URLSearchParams;for(var P in r.data)r.data[P]!==void 0&&r.data[P]!==null&&T.set(P,r.data[P]);r.data=T}return r},function(r){console.log(r),Promise.reject(r)}),j.interceptors.response.use(function(r){switch(r.status){case 200:break;case 401:S.m8.replace("/login");default:return Promise.reject(r)}return r},function(r){return r.response?console.error("API Error:",r.response.data):r.request?console.error("Network Error:",r.request):console.error("Error:",r.message),Promise.reject(r)});function H(r){if(!r)return[];var b=r.split(";"),A=[],T=_createForOfIteratorHelper(b),P;try{for(T.s();!(P=T.n()).done;){var ne=P.value,re=ne.trim().split("="),X=_slicedToArray(re,2),le=X[0],ae=X[1];A.push({key:le,value:ae})}}catch(ue){T.e(ue)}finally{T.f()}return A}},120:function(ce,k,t){t.r(k),t.d(k,{default:function(){return Be}});var z=t(5574),x=t.n(z),s=t(67294),D={container:"container___bXV7B",title:"title___TH1Ur",liveUrl:"liveUrl___E7uD9",m3u8:"m3u8____5PD_",playlist:"playlist___S8c1D",toolbar:"toolbar___JnoNk"},m=t(71114),S=t(78957),j=t(14726),H=t(5529),r=t(68872),b=t(72003),A=t(28459),T=t(24295),P=t(68795),ne=t(82911),re=t(89739),X=t(10844),le=t(4340),ae=t(63606),ue=t(2099),ye=t(60532),Ce=t(86548),je=t(48689),ge=t(42952),pe=t(57132),Ee=t(93967),Pe=t.n(Ee),Se=t(97857),ee=t.n(Se),Z=t(82250),i=t(27494),se=t(66184),Ze=t(49288),Fe=t(84567),F=t(88767),De={TsProxySelector:"TsProxySelector___q636z"},Y=t(2999),e=t(85893),be=m.Z.TextArea;function Ae(n){var l=i.Z.useForm(),c=x()(l,1),a=c[0],y=(0,s.useState)(!1),g=x()(y,2),C=g[0],p=g[1],V=(0,s.useState)(!1),U=x()(V,2),L=U[0],M=U[1],R=se.default.Option,B=(0,s.useRef)(null),W=(0,s.useState)(""),$=x()(W,2),N=$[0],O=$[1],G=(0,s.useState)(""),K=x()(G,2),I=K[0],Q=K[1],_=(0,F.useQuery)("parsers",function(){return Z.h.get("/plugins").then(function(f){return JSON.parse(f.data).map(function(d){return{label:d,value:d}})})}),h=_.data,J=(0,F.useQuery)("category",function(){return Z.h.get("/category").then(function(f){return JSON.parse(f.data).map(function(d){return{value:d}})})}),E=J.data,q=(0,s.useMemo)(function(){var f,d=I.trim();return d?(f=E==null?void 0:E.filter(function(w){return w.value.includes(d)}))!==null&&f!==void 0?f:[]:E},[E,I]);function te(){a==null||a.validateFields().then(function(f){p(!0),n.onAdd(ee()(ee()({},f),{},{Proxy:f.Proxy&&f.Proxy!=="0",TsProxy:f.Proxy==="2"?N:"",ProxyUrl:f.UseProxy?f.ProxyUrl:""})).then(function(){I&&!(E!=null&&E.find(function(d){return d.value===I}))&&Y.p.invalidateQueries("category")}).finally(function(){p(!1)})})}(0,s.useEffect)(function(){n.visible&&(M(!1),Q(""),a==null||a.resetFields(),a==null||a.setFieldValue("Parser","youtube"),n.mode==="edit"&&(a==null||a.setFieldsValue(ee()(ee()({},n.channel),{},{Proxy:n.channel.Proxy?n.channel.TsProxy?"2":"1":"0",UseProxy:!!n.channel.ProxyUrl})),M(!!n.channel.ProxyUrl),O(n.channel.TsProxy)))},[n.visible]);function ie(f,d){var w=d.UseProxy;M(!!w)}return(0,e.jsx)(b.Z,{open:n.visible,onCancel:n.onCancel,onOk:te,destroyOnClose:!0,maskClosable:!1,confirmLoading:C,title:n.mode==="add"?"\u6DFB\u52A0\u9891\u9053":"\u7F16\u8F91\u9891\u9053",okText:"\u786E\u5B9A",cancelText:"\u53D6\u6D88",children:(0,e.jsx)("div",{style:{marginTop:20},children:(0,e.jsxs)(i.Z,{labelCol:{span:6},form:a,onValuesChange:ie,children:[(0,e.jsx)(i.Z.Item,{name:"ID",hidden:!0}),(0,e.jsx)(i.Z.Item,{label:"\u9891\u9053\u540D",name:"Name",rules:[{required:!0}],children:(0,e.jsx)(m.Z,{placeholder:"\u9891\u9053\u540D",allowClear:!0})}),(0,e.jsx)(i.Z.Item,{label:"\u6E90\u5730\u5740",name:"URL",rules:[{required:!0}],children:n.mode==="add"?(0,e.jsx)(be,{placeholder:"\u652F\u6301\u5BFC\u5165\u591A\u4E2A\u6E90\uFF0C\u8BF7\u4EE5\u201C#\u201D\u9694\u5F00\uFF0C\u4F8B\u5982\uFF1Ahttps://example1.com #https://example2.com",allowClear:!0}):(0,e.jsx)(m.Z,{placeholder:"URL",allowClear:!0})}),(0,e.jsx)(i.Z.Item,{label:"\u89E3\u6790\u5668",name:"Parser",rules:[{required:!0}],children:(0,e.jsx)(se.default,{placeholder:"",options:h})}),(0,e.jsx)(i.Z.Item,{label:"\u5206\u7EC4",name:"Category",children:(0,e.jsx)(Ze.Z,{placeholder:"\u9009\u62E9\u6216\u8F93\u5165\u4E00\u4E2A\u65B0\u5206\u7EC4",options:q,onSearch:Q})}),(0,e.jsx)(i.Z.Item,{label:"\u4E32\u6D41\u4EE3\u7406",name:"Proxy",children:(0,e.jsxs)(se.default,{optionLabelProp:"title",defaultValue:"0",children:[(0,e.jsx)(R,{value:"0",title:"\u65E0\u4EE3\u7406",children:"\u65E0\u4EE3\u7406"}),(0,e.jsx)(R,{value:"1",title:"\u4E0Ebaseurl\u76F8\u540C",children:"\u4E0Ebaseurl\u76F8\u540C"}),(0,e.jsx)(R,{value:"2",title:"\u81EA\u5B9A\u4E49: "+N,children:(0,e.jsxs)("div",{className:De.TsProxySelector,children:[(0,e.jsx)("span",{children:"\u81EA\u5B9A\u4E49:"}),(0,e.jsx)(m.Z,{ref:B,onClick:function(d){var w;d.stopPropagation(),(w=B.current)===null||w===void 0||w.focus()},onDoubleClick:function(){var d;(d=B.current)===null||d===void 0||d.select()},placeholder:"https://example.com",value:N,onChange:function(d){return O(d.target.value)}})]})})]})}),(0,e.jsx)(i.Z.Item,{label:"\u4F7F\u7528\u4EE3\u7406",name:"UseProxy",valuePropName:"checked",children:(0,e.jsx)(Fe.Z,{})}),(0,e.jsx)(i.Z.Item,{label:"\u4EE3\u7406url",name:"ProxyUrl",hidden:!L,children:(0,e.jsx)(m.Z,{placeholder:"socks5://user:password@example.com:443"})})]})})})}var Te=t(75214),Oe=t(82188),Ie=t(73711),we=t(64576);function Ue(n){var l=i.Z.useForm(),c=x()(l,1),a=c[0],y=i.Z.useForm(),g=x()(y,1),C=g[0],p=(0,s.useState)("config"),V=x()(p,2),U=V[0],L=V[1];function M(){a.setFieldValue("baseurl",window.location.origin)}function R(){var h=Math.random().toString(36).substring(2);a.setFieldValue("secret",h)}var B=function(){return(0,e.jsxs)(i.Z,{labelCol:{span:6},form:a,children:[(0,e.jsx)(i.Z.Item,{name:"cmd",label:"yt-dlp Cmd",rules:[{required:!0}],children:(0,e.jsx)(m.Z,{placeholder:"yt-dlp"})}),(0,e.jsx)(i.Z.Item,{name:"args",label:"yt-dlp \u53C2\u6570",rules:[{required:!0}],children:(0,e.jsx)(m.Z,{placeholder:"--extractor-args youtube:skip=dash -f b -g {url}"})}),(0,e.jsx)(i.Z.Item,{name:"baseurl",label:"BaseUrl",rules:[{required:!0}],children:(0,e.jsx)(m.Z,{placeholder:window.location.origin,suffix:(0,e.jsx)(H.Z,{title:"\u586B\u5165\u5F53\u524D\u5730\u5740",children:(0,e.jsx)(Ie.Z,{onClick:M})})})}),(0,e.jsx)(i.Z.Item,{name:"secret",label:"\u670D\u52A1\u5668\u51ED\u8BC1",children:(0,e.jsx)(m.Z,{suffix:(0,e.jsx)(H.Z,{title:"\u968F\u673A\u751F\u6210",children:(0,e.jsx)(we.Z,{onClick:R})})})}),(0,e.jsx)(i.Z.Item,{name:"apikey",label:"Data API",children:(0,e.jsx)(m.Z,{})})]})},W=function(){return(0,e.jsxs)(i.Z,{labelCol:{span:7},form:C,children:[(0,e.jsx)(i.Z.Item,{name:"password",label:"\u65B0\u5BC6\u7801",rules:[{required:!0,message:"\u8F93\u5165\u65B0\u5BC6\u7801"}],children:(0,e.jsx)(m.Z,{type:"password"})}),(0,e.jsx)(i.Z.Item,{name:"password2",label:"\u91CD\u590D\u5BC6\u7801",rules:[{required:!0,message:"\u91CD\u65B0\u8F93\u5165\u4E00\u6B21"}],children:(0,e.jsx)(m.Z,{type:"password"})})]})},$=function(){return(0,e.jsxs)("div",{children:[(0,e.jsxs)("div",{children:["Based on ",(0,e.jsx)("a",{href:"https://github.com/zjyl1994/livetv",children:"LiveTV!"})," by ",(0,e.jsx)("a",{href:"https://github.com/zjyl1994",children:"zjyl1994."})]}),(0,e.jsxs)("div",{children:["Forked by ",(0,e.jsx)("a",{href:"https://github.com/snowie2000",children:"snowie2000"})]}),(0,e.jsxs)("div",{children:["Translated by ",(0,e.jsx)("a",{href:"https://github.com/cyndi905",children:"cyndi905"})]}),(0,e.jsxs)("div",{children:["Made with ",(0,e.jsx)("span",{style:{color:"#e25555"},children:"\u2665"})," in Kwangtung."]}),(0,e.jsxs)("div",{children:[(0,e.jsx)("a",{href:"/log",target:"_blank",children:"\u67E5\u770B\u65E5\u5FD7"}),"\xA0\xA0\xA0|\xA0\xA0\xA0",(0,e.jsx)("a",{onClick:function(){return I.mutate()},children:"\u767B\u51FA"})]})]})},N=(0,F.useQuery)("live-config",function(){return Z.h.get("/getconfig").then(function(h){return JSON.parse(h.data)})},{enabled:n.visible}),O=N.data;(0,s.useEffect)(function(){n.visible&&O&&a.setFieldsValue(O)},[O,n.visible]),(0,s.useEffect)(function(){n.visible&&L("config")},[n.visible]);var G=(0,F.useMutation)(function(h){return Z.h.post("/updconfig",h,{headers:{"Content-Type":"application/x-www-form-urlencoded"}})},{onSuccess:function(){Y.p.invalidateQueries("live-config")}}),K=(0,F.useMutation)(function(h){return Z.h.post("/changepwd",h,{headers:{"Content-Type":"application/x-www-form-urlencoded"}})}),I=(0,F.useMutation)(function(){return Z.h.get("/logout")},{onSuccess:function(){function J(E){document.cookie="".concat(E,"=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/")}J("mysession"),Oe.m8.replace("/login")}});function Q(){switch(U){case"config":{a.validateFields().then(G.mutateAsync).then(function(){return n.onClose()});break}case"password":{C.validateFields().then(function(h){return h.password!==h.password2?(r.ZP.warning("\u4E24\u6B21\u8F93\u5165\u5BC6\u7801\u4E0D\u4E00\u81F4"),Promise.reject()):K.mutateAsync(h)}).then(function(){I.mutate(),n.onClose()});break}case"about":{n.onClose();break}}}var _=[{label:"\u914D\u7F6E",key:"config",children:(0,e.jsx)(B,{})},{label:"\u5BC6\u7801",key:"password",children:(0,e.jsx)(W,{})},{label:"\u5173\u4E8E",key:"about",children:(0,e.jsx)($,{})}];return(0,e.jsx)(b.Z,{title:"\u7CFB\u7EDF\u914D\u7F6E",open:n.visible,onCancel:n.onClose,onOk:Q,destroyOnClose:!0,okText:"\u786E\u5B9A",cancelText:"\u53D6\u6D88",children:(0,e.jsx)(Te.Z,{items:_,defaultActiveKey:"config",activeKey:U,onChange:L})})}var Me=t(37029),oe=[{title:"#",width:60,dataIndex:"No"},{title:"\u5206\u7EC4",width:150,dataIndex:"Category",filterDropdown:function(l){var c=l.setSelectedKeys,a=l.selectedKeys,y=l.confirm,g=l.clearFilters;return(0,e.jsxs)("div",{style:{padding:8},children:[(0,e.jsx)(m.Z,{placeholder:"\u641C\u7D22\u5206\u7EC4",value:a[0],onChange:function(p){return c(p.target.value?[p.target.value]:[])},onPressEnter:function(){return y()},style:{marginBottom:8,display:"block"}}),(0,e.jsxs)(S.Z,{children:[(0,e.jsx)(j.ZP,{type:"primary",onClick:function(){return y()},icon:(0,e.jsx)(P.Z,{}),size:"small",style:{width:90},children:"\u641C\u7D22"}),(0,e.jsx)(j.ZP,{onClick:function(){g&&g(),y()},size:"small",style:{width:90},children:"\u91CD\u7F6E"})]})]})},filterIcon:function(l){return(0,e.jsx)(P.Z,{style:{color:l?"#1890ff":void 0}})},onFilter:function(l,c){return c.Category.toLowerCase().includes(l.toString().toLowerCase())}},{title:"\u9891\u9053\u540D",width:150,dataIndex:"Name",filterDropdown:function(l){var c=l.setSelectedKeys,a=l.selectedKeys,y=l.confirm,g=l.clearFilters;return(0,e.jsxs)("div",{style:{padding:8},children:[(0,e.jsx)(m.Z,{placeholder:"\u641C\u7D22\u9891\u9053\u540D",value:a[0],onChange:function(p){return c(p.target.value?[p.target.value]:[])},onPressEnter:function(){return y()},style:{marginBottom:8,display:"block"}}),(0,e.jsxs)(S.Z,{children:[(0,e.jsx)(j.ZP,{type:"primary",onClick:function(){return y()},icon:(0,e.jsx)(P.Z,{}),size:"small",style:{width:90},children:"\u641C\u7D22"}),(0,e.jsx)(j.ZP,{onClick:function(){g&&g(),y()},size:"small",style:{width:90},children:"\u91CD\u7F6E"})]})]})},filterIcon:function(l){return(0,e.jsx)(P.Z,{style:{color:l?"#1890ff":void 0}})},onFilter:function(l,c){return c.Name.toLowerCase().includes(l.toString().toLowerCase())}},{title:"\u6E90\u5730\u5740",dataIndex:"URL",render:function(l){return(0,e.jsx)("span",{className:D.liveUrl,children:l})}},{title:"\u9891\u9053M3U8\u5730\u5740",dataIndex:"M3U8",render:function(l,c,a){var y=[(0,e.jsx)(ne.Z,{style:{color:"#CCC"}}),(0,e.jsx)(re.Z,{style:{color:"#52c41a"}}),(0,e.jsx)(X.Z,{style:{color:"#faad14"}}),(0,e.jsx)(le.Z,{style:{color:"#ff4d4f"}}),(0,e.jsx)(X.Z,{style:{color:"#faad14"}})];return(0,e.jsxs)(S.Z,{children:[(0,e.jsx)(H.Z,{title:(0,e.jsxs)(e.Fragment,{children:[c.Message,(0,e.jsx)("br",{}),c.LastUpdate]}),children:y[c.Status]}),(0,e.jsx)("span",{className:D.m3u8,children:l})]})}},{title:"\u4EE3\u7406",width:80,render:function(l,c){return(0,e.jsxs)(S.Z,{children:[c.Proxy&&(0,e.jsx)(ae.Z,{title:"\u4EE3\u7406\u4E32\u6D41"}),!!c.ProxyUrl&&(0,e.jsx)(ue.Z,{title:"\u901A\u8FC7\u4EE3\u7406\u8FDE\u63A5"})]})}},{title:(0,e.jsx)(ye.Z,{}),width:80}];function he(n){return{id:n.ID,url:n.URL,name:n.Name,proxy:n.Proxy,parser:n.Parser,proxyurl:n.ProxyUrl,tsproxy:n.TsProxy,category:n.Category}}function Be(){var n=(0,s.useState)(!1),l=x()(n,2),c=l[0],a=l[1],y=(0,s.useState)(!1),g=x()(y,2),C=g[0],p=g[1],V=(0,s.useState)("add"),U=x()(V,2),L=U[0],M=U[1],R=(0,s.useState)(""),B=x()(R,2),W=B[0],$=B[1],N=(0,s.useState)(!1),O=x()(N,2),G=O[0],K=O[1],I=(0,s.useState)(),Q=x()(I,2),_=Q[0],h=Q[1],J=(0,s.useState)([]),E=x()(J,2),q=E[0],te=E[1],ie=function(o){te(o)},f={selectedRowKeys:q,onChange:ie},d=q.length>0;(0,s.useEffect)(function(){document.title="\u9891\u9053\u5217\u8868 - LiveTV!"},[]);var w=(0,F.useMutation)(function(u){return Z.h.post("/newchannel",he(u),{headers:{"Content-Type":"application/x-www-form-urlencoded"}})},{onSuccess:function(){Y.p.invalidateQueries("channelList")},onError:function(o){var v;r.ZP.error((v=o==null?void 0:o.data)!==null&&v!==void 0?v:"\u672A\u77E5\u9519\u8BEF")}}),fe=(0,F.useMutation)(function(u){return Z.h.get("/delchannel",{params:{id:u}})},{onSuccess:function(){Y.p.invalidateQueries("channelList")},onError:function(o){var v;r.ZP.error((v=o==null?void 0:o.data)!==null&&v!==void 0?v:"\u672A\u77E5\u9519\u8BEF")}}),Le=(0,F.useMutation)(function(u){return Z.h.post("/updatechannel",he(u),{headers:{"Content-Type":"application/x-www-form-urlencoded"}})},{onSuccess:function(){Y.p.invalidateQueries("channelList")},onError:function(o){var v;r.ZP.error((v=o==null?void 0:o.data)!==null&&v!==void 0?v:"\u672A\u77E5\u9519\u8BEF")}}),ve=(0,F.useQuery)("channelList",function(){return Z.h.get("/channels",{responseType:"json"}).then(function(u){var o=JSON.parse(u.data);return Array.isArray(o)&&o.length&&(o.forEach(function(v,Ve){v.Parser=v.Parser||"youtube",v.No=Ve}),$(o.shift().M3U8)),o!=null?o:[]})},{refetchInterval:15e3,refetchOnWindowFocus:!0}),de=ve.data,Re=ve.isLoading;function Ne(){M("add"),a(!0)}function Ke(u){return a(!1),L==="add"?w.mutateAsync(u):Le.mutateAsync(u)}function Qe(){navigator.clipboard.writeText(W).then(function(){K(!0),setTimeout(function(){K(!1)},3e3)}).catch(function(u){console.error("Failed to copy text:",u)})}var xe=(0,s.useCallback)(function(u){h(u),M("edit"),a(!0)},[]),ke=function(){b.Z.confirm({title:"\u6279\u91CF\u5220\u9664\u9891\u9053",content:"\u4F60\u771F\u7684\u60F3\u5220\u9664\u9009\u4E2D\u7684\u9891\u9053\u5417?",okText:"\u5220\u9664",cancelText:"\u53D6\u6D88",okType:"danger",onOk:function(){q.forEach(function(v){fe.mutate(v.toString())}),te([])}})},me=(0,s.useCallback)(function(u){b.Z.confirm({title:"\u5220\u9664\u9891\u9053",content:'\u4F60\u771F\u7684\u60F3\u5220\u9664 "'+u.Name+'" \u5417?',okText:"\u5220\u9664",cancelText:"\u53D6\u6D88",okType:"danger",onOk:function(){fe.mutate(u.ID)}})},[]),ze=(0,s.useMemo)(function(){return oe[oe.length-1].render=function(u,o){return(0,e.jsxs)(S.Z,{children:[(0,e.jsx)(Ce.Z,{onClick:function(){return xe(o)}}),(0,e.jsx)(je.Z,{onClick:function(){return me(o)}})]})},oe},[xe,me]);return(0,e.jsx)(A.ZP,{locale:Me.Z,children:(0,e.jsxs)("div",{className:D.container,children:[(0,e.jsx)("h1",{className:D.title,children:(0,e.jsxs)(S.Z,{children:["LiveTV! ",(0,e.jsx)("small",{children:"\u5B9A\u5236\u4F60\u81EA\u5DF1\u7684IPTV"}),(0,e.jsx)(ge.Z,{style:{fontSize:"16px"},onClick:function(){return p(!0)}})]})}),(0,e.jsxs)("div",{className:D.toolbar,children:[(0,e.jsxs)("div",{className:Pe()([D.playlist,"flex"]),children:[(0,e.jsx)("span",{children:"\u5217\u8868url:\xA0\xA0"}),(0,e.jsxs)(S.Z.Compact,{style:{flex:"1 1 99%"},children:[(0,e.jsx)(m.Z,{value:W,readOnly:!0}),(0,e.jsx)(H.Z,{title:G?"\u5DF2\u590D\u5236":"\u70B9\u51FB\u590D\u5236",children:(0,e.jsx)(j.ZP,{icon:(0,e.jsx)(pe.Z,{}),onClick:Qe})})]})]}),(0,e.jsxs)("div",{children:[(0,e.jsx)(j.ZP,{type:"primary",onClick:Ne,style:{marginLeft:"5px"},children:"\u65B0\u589E\u9891\u9053"}),(0,e.jsx)(j.ZP,{type:"primary",danger:!0,onClick:ke,disabled:!d,style:{marginLeft:"5px"},children:"\u6279\u91CF\u5220\u9664"})]})]}),(0,e.jsx)(T.Z,{size:"middle",locale:{emptyText:(0,e.jsx)("div",{style:{textAlign:"center"},children:"\u8FD8\u6CA1\u6DFB\u52A0\u8FC7\u9891\u9053\u54E6\uFF01"})},scroll:{x:"100%"},rowKey:"ID",dataSource:de!=null?de:[],loading:Re,columns:ze,pagination:{defaultPageSize:20,pageSizeOptions:[10,20,50,100],showSizeChanger:!0},rowSelection:f}),(0,e.jsx)(Ae,{mode:L,visible:c,channel:_,onAdd:Ke,onCancel:function(){return a(!1)}}),(0,e.jsx)(Ue,{visible:C,onClose:function(){return p(!1)}})]})})}}}]);
